
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../04_ProceduralKnowledgeLearning/">
      
      
        <link rel="next" href="../06_SemanticMemory/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.8">
    
    
      
        <title>Reinforcement Learning - Soar documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reinforcement-learning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  This documentation is still work in progress. The documentation is hosted at <a href="https://soar.eecs.umich.edu">the Soar homepage</a>! 

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Soar documentation" class="md-header__button md-logo" aria-label="Soar documentation" data-md-component="logo">
      
  <img src="../../Images/soar.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Soar documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reinforcement Learning
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="http://github.com/SoarGroup/Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SoarGroup/Documentation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
    
  
  Soar

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Soar Manual

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../explanations/" class="md-tabs__link">
          
  
    
  
  Explanations

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/" class="md-tabs__link">
          
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../how_to/" class="md-tabs__link">
          
  
    
  
  HowTo Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/" class="md-tabs__link">
          
  
    
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../soar/tags/" class="md-tabs__link">
        
  
    
  
  Tag Index

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Soar documentation" class="md-nav__button md-logo" aria-label="Soar documentation" data-md-component="logo">
      
  <img src="../../Images/soar.png" alt="logo">

    </a>
    Soar documentation
  </label>
  
    <div class="md-nav__source">
      <a href="http://github.com/SoarGroup/Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SoarGroup/Documentation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Soar
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_1">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Soar
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
        
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Research
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/Publications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/ResearchGroups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Research Groups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/OtherAcademicInstitutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Academic Institutions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/CommercialSoarOrganizations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Commercial Soar Organizations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Soar Manual
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Soar Manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../01_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../02_TheSoarArchitecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Soar Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../03_SyntaxOfSoarPrograms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syntax of Soar Programs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../04_ProceduralKnowledgeLearning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Procedural Knowledge Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Reinforcement Learning
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rl-rules" class="md-nav__link">
    RL Rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reward-representation" class="md-nav__link">
    Reward Representation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-rl-rule-values" class="md-nav__link">
    Updating RL Rule Values
  </a>
  
    <nav class="md-nav" aria-label="Updating RL Rule Values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gaps-in-rule-coverage" class="md-nav__link">
    Gaps in Rule Coverage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rl-and-substates" class="md-nav__link">
    RL and Substates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eligibility-traces" class="md-nav__link">
    Eligibility Traces
  </a>
  
    <nav class="md-nav" aria-label="Eligibility Traces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploration" class="md-nav__link">
    Exploration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gqlambda" class="md-nav__link">
    GQ(\(\lambda\))
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-generation-of-rl-rules" class="md-nav__link">
    Automatic Generation of RL Rules
  </a>
  
    <nav class="md-nav" aria-label="Automatic Generation of RL Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-gp-command" class="md-nav__link">
    The gp Command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-templates" class="md-nav__link">
    Rule Templates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chunking" class="md-nav__link">
    Chunking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#footnotes" class="md-nav__link">
    Footnotes
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../06_SemanticMemory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Semantic Memory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../07_EpisodicMemory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Episodic Memory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../08_SpatialVisualSystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial Visual System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../09_SoarUserInterface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soar User Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../blocksworld/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blocksworld
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../explanations/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Explanations
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Explanations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/BasicKernelTerminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Kernel Terminology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/DesignDogma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design Dogma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/ThreadsInSML/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threads in SML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/Timers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/Waterfall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Waterfall
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/IntroSoarDebugger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Soar Debugger Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/SMLQuickStartGuide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soar Markup Language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/soar_tutorial/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Official Soar Tutorials
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_4_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Official Soar Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/soar_tutorial/TankEatersConfigFile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tank and Eaters Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../how_to/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    HowTo Guides
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            HowTo Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/BuildingSoarRos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Soar and ROS1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/CLIParsingCode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI Parsing Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/HowToCompileSmlClients/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to compile SML Clients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/IOAndRewardLinks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO and Reward Links
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/MemoryLeakDebuggingWithVisualStudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory Leak Debugging with Visual Studio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/SMLOutputLinkGuide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SML Output Link Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/SoarTechnicalFAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soar Technical FAQ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/cli/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Command Line Interface
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_6_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Command Line Interface
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_alias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    alias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_trace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    trace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_help/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    help
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_sp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_load/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    load
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_gp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_wm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_rl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_default_wme_depth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    default_wme_depth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_stop_soar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stop_soar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_alias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    alias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_echo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    echo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_command_to_file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    command_to_file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_unalias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unalias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_epmem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    epmem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_clog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_visualize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    visualize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_preferences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    preference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_excise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    excise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_production/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    production
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_wma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_smem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_chunk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chunk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_soar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    soar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_svs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    svs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_explain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    explain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_init_soar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    init_soar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_decide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_print/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    print
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_debug/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    debug
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_timers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_watch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    watch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_save/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    save
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_max_nil_output_cycles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    max_nil_output_cycles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_file_system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    output
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tag Index
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rl-rules" class="md-nav__link">
    RL Rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reward-representation" class="md-nav__link">
    Reward Representation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-rl-rule-values" class="md-nav__link">
    Updating RL Rule Values
  </a>
  
    <nav class="md-nav" aria-label="Updating RL Rule Values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gaps-in-rule-coverage" class="md-nav__link">
    Gaps in Rule Coverage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rl-and-substates" class="md-nav__link">
    RL and Substates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eligibility-traces" class="md-nav__link">
    Eligibility Traces
  </a>
  
    <nav class="md-nav" aria-label="Eligibility Traces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploration" class="md-nav__link">
    Exploration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gqlambda" class="md-nav__link">
    GQ(\(\lambda\))
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-generation-of-rl-rules" class="md-nav__link">
    Automatic Generation of RL Rules
  </a>
  
    <nav class="md-nav" aria-label="Automatic Generation of RL Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-gp-command" class="md-nav__link">
    The gp Command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-templates" class="md-nav__link">
    Rule Templates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chunking" class="md-nav__link">
    Chunking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#footnotes" class="md-nav__link">
    Footnotes
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="reinforcement-learning">Reinforcement Learning</h1>
<p>Soar has a reinforcement learning (RL) mechanism that tunes operator selection
knowledge based on a given reward function. This chapter describes the RL
mechanism and how it is integrated with production memory, the decision cycle,
and the state stack. We assume that the reader is familiar with basic
reinforcement learning concepts and notation. If not, we recommend first
reading <em>Reinforcement Learning: An Introduction</em> (1998) by Richard S. Sutton and
Andrew G. Barto. The detailed behavior of the RL mechanism is determined by
numerous parameters that can be controlled and configured via the <code>rl</code> command.
Please refer to the documentation for that command in section 9.4.2 on page 238.</p>
<h2 id="rl-rules">RL Rules</h2>
<p>Soarâ€™s RL mechanism learns Q-values for state-operator<sup><a href="#footnote1">1</a></sup>
pairs. Q-values are stored as numeric-indifferent preferences created by
specially formulated productions called <strong>RL rules</strong>.  RL rules are identified
by syntax. A production is a RL rule if and only if its left hand side tests for
a proposed operator, its right hand side creates a single numeric-indifferent
preference, and it is not a template rule (see Section 5.4.2 for template
rules). These constraints ease the technical requirements of identifying/
updating RL rules and makes it easy for the agent programmer to add/ maintain RL
capabilities within an agent. We define an
<strong>RL operator</strong> as an operator with numeric-indifferent preferences created by
RL rules.</p>
<p>The following is an RL rule:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sp {rl*3*12*left
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>  (state &lt;s&gt; ^name task-name
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    ^x 3
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    ^y 12
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    ^operator &lt;o&gt; +)
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>  (&lt;o&gt; ^name move
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    ^direction left)
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>--&gt;
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>(&lt;s&gt; ^operator &lt;o&gt; = 1.5)
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>}
</span></code></pre></div>
<p>Note that the LHS of the rule can test for anything as long as it contains a
test for a proposed operator. The RHS is constrained to exactly one action:
creating a numeric-indifferent preference for the proposed operator.</p>
<p>The following are not RL rules:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sp {multiple*preferences
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>(state &lt;s&gt; ^operator &lt;o&gt; +)
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>--&gt;
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>(&lt;s&gt; ^operator &lt;o&gt; = 5, &gt;)
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>}
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>sp {variable*binding
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>(state &lt;s&gt; ^operator &lt;o&gt; +
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>^value &lt;v&gt;)
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>--&gt;
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>(&lt;s&gt; ^operator &lt;o&gt; = &lt;v&gt;)
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>}
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>sp {invalid*actions
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>(state &lt;s&gt; ^operator &lt;o&gt; +)
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>--&gt;
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>(&lt;s&gt; ^operator &lt;o&gt; = 5)
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>(write (crlf) |This is not an RL rule.|)
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>}
</span></code></pre></div>
<p>The first rule proposes multiple preferences for the proposed operator and thus
does not comply with the rule format. The second rule does not comply because it
does not provide a constant for the numeric-indifferent preference value. The
third rule does not comply because it includes a RHS function action in addition
to the numeric-indifferent preference action.</p>
<p>In the typical RL use case, the user intends for the agent to learn the best
operator in each possible state of the environment. The most straightforward way
to achieve this is to give the agent a set of RL rules, each matching exactly
one possible state-operator pair.  This approach is equivalent to a table-based
RL algorithm, where the Q-value of each state- operator pair corresponds to the
numeric-indifferent preference created by exactly one RL rule.</p>
<p>In the more general case, multiple RL rules can match a single state-operator
pair, and a single RL rule can match multiple state-operator pairs. That is, in
Soar, a state-operator pair corresponds to an operator in a specific working
memory context, and multiple rules can modify the preferences for a single
operator, and a single rule can be instantiated multiple ways to modify
preferences for multiple operators. For RL in Soar, all numeric-indifferent
preferences for an operator are summed when calculating the operatorâ€™s
Q-value<sup><a href="#footnote2">2</a></sup>. In this context, RL rules can be interpreted more generally as binary
features in a linear approximator of each state-operator pairâ€™s Q-value, and
their numeric-indifferent preference values their weights. In other words,</p>
<div class="arithmatex">\[Q(s, a) = w_1 \phi_2 (s, a) + w_2 \phi_2 (s, a) + \ldots + w_n \phi_n (s, a)\]</div>
<p>where all RL rules in production memory are numbered <span class="arithmatex">\(1 \dots n\)</span>, <span class="arithmatex">\(Q(s, a)\)</span> is
the Q-value of the state-operator pair <span class="arithmatex">\((s, a)\)</span>, <span class="arithmatex">\(w_i\)</span> is the
numeric-indifferent preference value of RL rule <span class="arithmatex">\(i\)</span>, <span class="arithmatex">\(\phi_i (s, a) = 0\)</span> if RL
rule <span class="arithmatex">\(i\)</span> does not match <span class="arithmatex">\((s, a)\)</span>, and <span class="arithmatex">\(\phi_i (s, a) = 1\)</span> if it does.  This
interpretation allows RL rules to simulate a number of popular function
approximation schemes used in RL such as tile coding and sparse coding.</p>
<h2 id="reward-representation">Reward Representation</h2>
<p>RL updates are driven by reward signals. In Soar, these reward signals are given
to the RL mechanism through a working memory link called the <strong>reward-link</strong>.
Each state in Soarâ€™s state stack is automatically populated with
a reward-link structure upon creation. Soar will check each structure for a
numeric reward signal for the last operator executed in the associated state at
the beginning of every decision phase. Reward is also collected when the agent
is halted or a state is retracted.</p>
<p>In order to be recognized, the reward signal must follow this pattern:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>(&lt;r1&gt; ^reward &lt;r2&gt;)
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>(&lt;r2&gt; ^value [val])
</span></code></pre></div>
<p>where <code>&lt;r1&gt;</code> is the reward-link identifier, <code>&lt;r2&gt;</code> is some intermediate
identifier, and <code>[val]</code> is any constant numeric value. Any structure that does not
match this pattern is ignored. If there are multiple valid reward signals, their
values are summed into a single reward signal.  As an example, consider the
following state:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>(S1 ^reward-link R1)
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>(R1 ^reward R2)
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>(R2 ^value 1.0)
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>(R1 ^reward R3)
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>(R3 ^value -0.2)
</span></code></pre></div>
<p>In this state, there are two reward signals with values 1.0 and -0.2. They will
be summed together for a total reward of 0.8 and this will be the value given to
the RL update algorithm.</p>
<p>There are two reasons for requiring the intermediate identifier. The first is so
that multiple reward signals with the same value can exist simultaneously. Since
working memory is a set, multiple WMEs with identical values in all three
positions (identifier, attribute, value) cannot exist simultaneously. Without an
intermediate identifier, specifying two rewards with the same value would
require a WME structure such as</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>(S1 ^reward-link R1)
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>(R1 ^reward 1.0)
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>(R1 ^reward 1.0)
</span></code></pre></div>
<p>which is invalid. With the intermediate identifier, the rewards would be specified as</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>(S1 ^reward-link R1)
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>(R1 ^reward R2)
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>(R2 ^value 1.0)
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>(R1 ^reward R3)
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>(R3 ^value 1.0)
</span></code></pre></div>
<p>which is valid. The second reason for requiring an intermediate identifier in
the reward signal is so that the rewards can be augmented with additional
information, such as their source or how long they have existed. Although this
information will be ignored by the RL mechanism, it can be useful to the agent
or programmer. For example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>(S1 ^reward-link R1)
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>(R1 ^reward R2)
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>(R2 ^value 1.0)
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>(R2 ^source environment)
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>(R1 ^reward R3)
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>(R3 ^value -0.2)
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>(R3 ^source intrinsic)
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>(R3 ^duration 5)
</span></code></pre></div>
<p>The <code>(R2 ^source environment)</code>,<code>(R3 ^source intrinsic)</code>, and <code>(R3 ^duration 5)</code>
WMEs are arbitrary and ignored by RL, but were added by the agent to keep track
of where the rewards came from and for how long.</p>
<p>Note that the reward-link is not part of the io structure and is not modified
directly by the environment. Reward information from the environment should be
copied, via rules, from the input-link to the reward-link. Also note that when
collecting rewards, Soar simply scans the reward-link and sums the values of all
valid reward WMEs. The WMEs are not modified and no bookkeeping is done to keep
track of previously seen WMEs. This means that reward WMEs that exist for
multiple decision cycles will be collected multiple times if not removed or
retracted.</p>
<h2 id="updating-rl-rule-values">Updating RL Rule Values</h2>
<p>Soarâ€™s RL mechanism is integrated naturally with the decision cycle and performs
online updates of RL rules. Whenever an RL operator is selected, the values of
the corresponding RL rules will be updated. The update can be on-policy (Sarsa)
or off-policy (Q-Learning), as controlled by the <strong>learning-policy</strong> parameter
of the rl command. (See page 238.) Let <span class="arithmatex">\(\delta_t\)</span> be the amount of change for the
Q-value of an RL operator in a single update. For Sarsa, we have</p>
<div class="arithmatex">\[ \delta_t = \alpha \left[ r_{t+1} + \gamma Q(s_{t+1}, a_{t+1}) - Q(s_t, a_t)
\right] \]</div>
<p>where</p>
<ul>
<li><span class="arithmatex">\(Q(s_t, a_t)\)</span> is the Q-value of the state and chosen operator in decision cycle <span class="arithmatex">\(t\)</span>.</li>
<li><span class="arithmatex">\(Q(s_{t+1}, a_{t+1})\)</span> is the Q-value of the state and chosen RL operator in the next decision cycle.</li>
<li><span class="arithmatex">\(r_{t+1}\)</span> is the total reward collected in the next decision cycle.</li>
<li><span class="arithmatex">\(\alpha\)</span> and <span class="arithmatex">\(\gamma\)</span> are the settings of the learning-rate and discount-rate parameters of the <code>rl</code> command, respectively.</li>
</ul>
<p>Note that since <span class="arithmatex">\(\delta_t\)</span> depends on <span class="arithmatex">\(Q(s_{t+1}, a_{t+1})\)</span>, the update for the
operator selected in decision cycle <span class="arithmatex">\(t\)</span> is not applied until the next RL
operator is chosen.  For Q-Learning, we have
<script type="math/tex; mode=display"> \delta_t = \alpha \left[ r_{t+1} + \gamma \underset{a \in A_{t+1}}{\max} Q(s_{t+1}, a) - Q(s_t, a_t) \right] </script>
where <span class="arithmatex">\(A_{t+1}\)</span> is the set of RL operators proposed in the next decision cycle.</p>
<p>Finally, <span class="arithmatex">\(\delta_t\)</span> is divided by the number of RL rules comprising the Q-value
for the operator and the numeric-indifferent values for each RL rule is updated
by that amount.</p>
<p>An example walkthrough of a Sarsa update with <span class="arithmatex">\(\alpha = 0.3\)</span> and <span class="arithmatex">\(\gamma = 0.9\)</span>
(the default settings in Soar) follows.</p>
<ol>
<li>
<p>In decision cycle <span class="arithmatex">\(t\)</span>, an operator <code>O1</code> is proposed, and RL rules <strong>rl-1</strong>
  and <strong>rl-2</strong> create the following numeric-indifferent preferences for it:
  <div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>rl-1: (S1 ^operator O1 = 2.3)
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>rl-2: (S1 ^operator O1 = -1)
</span></code></pre></div>
  The Q-value for <code>O1</code> is <span class="arithmatex">\(Q(s_t, \textbf{O1}) = 2.3 - 1 = 1.3\)</span>.</p>
</li>
<li>
<p><code>O1</code> is selected and executed, so  <span class="arithmatex">\(Q(s_t, a_t) = Q(s_t, \textbf{O1}) = 1.3\)</span>.</p>
</li>
<li>
<p>In decision cycle <span class="arithmatex">\(t+1\)</span>, a total reward of 1.0 is collected on the
  reward-link, an operator O2is proposed, and another RL rule <strong>rl-3</strong> creates the
  following numeric-indifferent preference for it:
  <div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>rl-3: (S1 ^operator O2 = 0.5)
</span></code></pre></div></p>
</li>
</ol>
<p>So <span class="arithmatex">\(Q(s_{t+1}, \textbf{O2}) = 0.5\)</span>.</p>
<ol>
<li><code>O2</code> is selected, so  <span class="arithmatex">\(Q(s_{t+1}, a_{t+1}) = Q(s_{t+1}, \textbf{O2}) = 0.5\)</span> Therefore,</li>
</ol>
<div class="arithmatex">\[\delta_t = \alpha \left[r_{t+1} + \gamma Q(s_{t+1}, a_{t+1}) - Q(s_t, a_t) \right] = 0.3 \times [ 1.0 + 0.9 \times 0.5 - 1.3 ] = 0.045\]</div>
<p>Since rl-1 and rl-2 both contributed to the Q-value of O1, <span class="arithmatex">\(\delta_t\)</span> is evenly divided
amongst them, resulting in updated values of</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>rl-1: (&lt;s&gt; ^operator &lt;o&gt; = 2.3225)
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>rl-2: (&lt;s&gt; ^operator &lt;o&gt; = -0.9775)
</span></code></pre></div>
<ol>
<li><strong>rl-3</strong> will be updated when the next RL operator is selected.</li>
</ol>
<h3 id="gaps-in-rule-coverage">Gaps in Rule Coverage</h3>
<p>The previous description had assumed that RL operators were selected in both decision
cyclestandt+ 1. If the operator selected int+ 1 is not an RL operator, thenQ(st+1,at+1)
would not be defined, and an update for the RL operator selected at timetwill be undefined.
We will call a sequence of one or more decision cycles in which RL operators are not selected
between two decision cycles in which RL operators are selected agap. Conceptually, it is
desirable to use the temporal difference information from the RL operator after the gap to
update the Q-value of the RL operator before the gap. There are no intermediate storage
locations for these updates. Requiring that RL rules support operators at every decision
can be difficult for agent programmers, particularly for operators that do not represent steps
in a task, but instead perform generic maintenance functions, such as cleaning processed
output-link structures.</p>
<p>To address this issue, Soar's RL mechanism supports automatic propagation of updates over gaps.
For a gap of length <span class="arithmatex">\(n\)</span>, the Sarsa update is
<span class="arithmatex">\(<span class="arithmatex">\(\delta_t = \alpha \left[ \sum_{i=t}^{t+n}{\gamma^{i-t} r_i} + \gamma^{n+1} Q(s_{t+n+1}, a_{t+n+1}) - Q(s_t, a_t) \right]\)</span>\)</span>
and the Q-Learning update is
<span class="arithmatex">\(<span class="arithmatex">\(\delta_t = \alpha \left[ \sum_{i=t}^{t+n}{\gamma^{i-t} r_i} + \gamma^{n+1} \underset{a \in A_{t+n+1}}{\max} Q(s_{t+n+1}, a) - Q(s_t, a_t) \right]\)</span>\)</span></p>
<p>Note that rewards will still be collected during the gap, but they are discounted based on the number of decisions they are removed from the initial RL operator.</p>
<p>Gap propagation can be disabled by setting the <strong>temporal-extension</strong> parameter of the
rl command to off. When gap propagation is disabled, the RL rules preceding a gap are
updated usingQ(st+1,at+1) = 0. The rl setting of the watch command (see Section 9.6.1
on page 259) is useful in identifying gaps.</p>
<figure class="figure-image">  <img src="../Images/rl-optrace.svg" alt="Example Soar substate operator trace." >  <figcaption>Example Soar substate operator trace.</figcaption></figure>

<h3 id="rl-and-substates">RL and Substates</h3>
<p>When an agent has multiple states in its state stack, the RL mechanism will treat each
substate independently. As mentioned previously, each state has its own reward-link.
When an RL operator is selected in a stateS, the RL updates for that operator are only
affected by the rewards collected on the reward-link for Sand the Q-values of subsequent
RL operators selected inS.</p>
<p>The only exception to this independence is when a selected RL operator forces an
operator- no-change impasse. When this occurs, the number of decision cycles the
RL operator at the superstate remains selected is dependent upon the processing
in the impasse state. Consider the operator trace in Figure 5.1.</p>
<p>ÂˆAt decision cycle 1, RL operatorO1is selected inS1and causes an
operator-no-change impass for three decision cycles.  ÂˆIn the substateS2,
operatorsO2,O3, andO4are selected and applied sequentially.  ÂˆMeanwhile inS1,
rewardsr 2 ,r 3 , andr 4 are put on thereward-linksequentially.  ÂˆFinally, the
impasse is resolved by O4, the proposal for O1 is retracted, and RL operatorO5is
selected inS1.</p>
<p>In this scenario, only the RL update forQ(s 1 ,O1) will be different from the
ordinary case.  Its value depends on the setting of the <strong>hrl-discount</strong>
parameter of the rlcommand.  When this parameter is set to the default valueon,
the rewards onS1and the Q-value of O5are discounted by the number of decision
cycles they are removed from the selection of O1. In this case the update for  <span class="arithmatex">\(Q(s_1, \textbf{O1})\)</span> is</p>
<div class="arithmatex">\[\delta_1 = \alpha \left[ r_2 + \gamma r_3 + \gamma^2 r_4 + \gamma^3 Q(s_5, \textbf{O5}) - Q(s_1, \textbf{O1}) \right]\]</div>
<p>which is equivalent to having a three decision gap separating <code>O1</code> and <code>O5</code>.</p>
<p>When hrl-discount is set to off, the number of cycles O1has been impassed will be
ignored. Thus the update would be</p>
<div class="arithmatex">\[\delta_1 = \alpha \left[ r_2 + r_3 + r_4 + \gamma Q(s_5, \textbf{O5}) - Q(s_1, \textbf{O1}) \right]\]</div>
<p>For impasses other than operator no-change, RL acts as if the impasse hadnâ€™t
occurred. If O1is the last RL operator selected before the impasse,r 2 the
reward received in the decision cycle immediately following, and On, the first
operator selected after the impasse, thenO1 is updated with </p>
<div class="arithmatex">\[\delta_1 = \alpha \left[ r_2 + \gamma Q(s_n, \textbf{O}_\textbf{n}) - Q(s_1, \textbf{O1}) \right]\]</div>
<p>If an RL operator is selected in a substate immediately prior to the stateâ€™s
retraction, the RL rules will be updated based only on the reward signals
present and not on the Q-values of future operators. This point is not covered
in traditional RL theory. The retraction of a substate corresponds to a
suspension of the RL task in that state rather than its termination, so the last
update assumes the lack of information about future rewards rather than the
discontinuation of future rewards. To handle this case, the numeric-indifferent
preference value of each RL rule is stored as two separate values, the expected
current reward(ECR) and expected future reward (EFR). The ECR is an estimate of
the expected immediate reward signal for executing the corresponding RL
operator. The EFR is an estimate of the time discounted Q-value of the next RL
operator. Normal updates correspond to traditional RL theory (showing the Sarsa
case for simplicity):</p>
<div class="arithmatex">\[ \delta_{ECR} = \alpha \left[ r_t - ECR(s_t, a_t) \right] \]</div>
<div class="arithmatex">\[ \delta_{EFR} = \alpha \left[ \gamma Q(s_{t+1}, a_{t+1}) - EFR(s_t, a_t) \right] \]</div>
<div class="arithmatex">\[ \delta_t = \delta_{ECR} + \delta_{EFR} \]</div>
<div class="arithmatex">\[ = \alpha \left[ r_t + \gamma Q(s_{t+1}, a_{t+1}) - \left( ECR(s_t, a_t) + EFR(s_t, a_t) \right) \right] \]</div>
<div class="arithmatex">\[ = \alpha \left[ r_t + \gamma Q(s_{t+1}, a_{t+1}) - Q(s_t, a_t) \right] \]</div>
<p>During substate retraction, only the ECR is updated based on the reward signals
present at the time of retraction, and the EFR is unchanged.</p>
<p>Soarâ€™s automatic subgoaling and RL mechanisms can be combined to naturally implement
hierarchical reinforcement learning algorithms such as MAXQ and options.</p>
<h3 id="eligibility-traces">Eligibility Traces</h3>
<p>The RL mechanism supports eligibility traces, which can improve the speed of
learning by updating RL rules across multiple sequential steps. The
<strong>eligibility-trace-decay-rate</strong> and <strong>eligibility-trace-tolerance</strong> parameters
<em>control this mechanism. By setting eligibility-trace-decay-rate to 0
(de- fault), eligibility traces are in effect disabled. When eligibility traces
are enabled, the particular algorithm used is dependent upon the learning
policy. For Sarsa, the eligibility trace implementation isSarsa(<span class="arithmatex">\(\lambda\)</span>). For
Q-Learning, the eligibility trace implementation is </em>Watkin's Q(<span class="arithmatex">\(\lambda\)</span>)*.</p>
<h4 id="exploration">Exploration</h4>
<p>The decide indifferent-selection command (page 198) determines how operators are
selected based on their numeric-indifferent preferences. Although all the
indifferent selection settings are valid regardless of how the
numeric-indifferent preferences were arrived at, the epsilon-greedy and
boltzmann settings are specifically designed for use with RL and cor- respond to
the two most common exploration strategies. In an effort to maintain backwards
compatibility, the default exploration policy is soft max. As a result, one
should change to epsilon-greedy or boltzmann when the reinforcement learning
mechanism is enabled.</p>
<h3 id="gqlambda">GQ(<span class="arithmatex">\(\lambda\)</span>)</h3>
<p>Sarsa(<span class="arithmatex">\(\lambda\)</span>) and Watkinâ€™s Q(<span class="arithmatex">\(\lambda\)</span>) help agents to solve the temporal
credit assignment problem more quickly. However, if you wish to implement
something akin to CMACs to generalize from experience, convergence is not
guaranteed by these algorithms. GQ(<span class="arithmatex">\(\lambda\)</span>) is a gradient descent algorithm
designed to ensure convergence when learning off-policy. Soarâ€™s learning-policy
can be set to
<strong>on-policy-gq-lambda</strong> or <strong>off-policy-gq-lambda</strong> to increase the likelihood
of convergence when learning under these conditions. If you should choose to use
one of these algorithms, we recommend setting the rl <strong>step-size-parameter</strong> to
something small, such as 0.01 in order to ensure that the secondary set of
weights used by GQ(<span class="arithmatex">\(\lambda\)</span>)change slowly enough for efficient convergence.</p>
<h2 id="automatic-generation-of-rl-rules">Automatic Generation of RL Rules</h2>
<p>The number of RL rules required for an agent to accurately approximate operator
Q-values is usually unfeasibly large to write by hand, even for small domains.
Therefore, several methods exist to automate this.</p>
<h3 id="the-gp-command">The gp Command</h3>
<p>The gp command can be used to generate productions based on simple patterns.
This is useful if the states and operators of the environment can be
distinguished by a fixed number of dimensions with finite domains. An example is
a grid world where the states are described by integer row/column coordinates,
and the available operators are to move north, south, east, or west. In this
case, a single gp command will generate all necessary RL rules:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>gp {gen*rl*rules
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>(state &lt;s&gt; ^name gridworld
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>^operator &lt;o&gt; +
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>^row [ 1 2 3 4 ]
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>^col [ 1 2 3 4 ])
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>(&lt;o&gt; ^name move
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>^direction [ north south east west ])
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>--&gt;
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>(&lt;s&gt; ^operator &lt;o&gt; = 0.0)
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>}
</span></code></pre></div>
<p>For more information see the documentation for this command on page 205.</p>
<h3 id="rule-templates">Rule Templates</h3>
<p>Rule templates allow Soar to dynamically generate new RL rules based on a
predefined pattern as the agent encounters novel states. This is useful when
either the domains of environment dimensions are not known ahead of time, or
when the enumerable state space of the environment is too large to capture in
its entirety using gp, but the agent will only encounter a small fraction of
that space during its execution. For example, consider the grid world example
with 1000 rows and columns. Attempting to generate RL rules for each grid cell
and action a priori will result in <span class="arithmatex">\(1000 \times 1000 \times 4 = 4 \times 10^6\)</span>
productions. However, if most of those cells are unreachable due to walls, then
the agent will never fire or update most of those productions. Templates give
the programmer the convenience of the gp command without filling production
memory with unnecessary rules.</p>
<p>Rule templates have variables that are filled in to generate RL rules as the
agent encounters novel combinations of variable values. A rule template is valid
if and only if it is marked with the <strong>:template</strong> flag and, in all other
respects, adheres to the format of an RL rule.  However, whereas an RL rule may
only use constants as the numeric-indifference preference value, a rule template
may use a variable. Consider the following rule template:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>sp {sample*rule*template
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>:template
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>(state &lt;s&gt; ^operator &lt;o&gt; +
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>^value &lt;v&gt;)
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>--&gt;
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>(&lt;s&gt; ^operator &lt;o&gt; = &lt;v&gt;)
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>}
</span></code></pre></div>
<p>During agent execution, this rule template will match working memory and create new
productions by substituting all variables in the rule template that matched against constant
values with the values themselves. Suppose that the LHS of the rule template matched
against the state</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>(S1 ^value 3.2)
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>(S1 ^operator O1 +)
</span></code></pre></div>
<p>Then the following production will be added to production memory:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>sp {rl*sample*rule*template*1
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>(state &lt;s&gt; ^operator &lt;o&gt; +
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>^value 3.2)
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>--&gt;
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>(&lt;s&gt; ^operator &lt;o&gt; = 3.2)
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>}
</span></code></pre></div>
<p>The variable <code>&lt;v&gt;</code> is replaced by3.2on both the LHS and the RHS, but <code>&lt;s&gt;</code> and
<code>&lt;o&gt;</code> are not replaced because they matches against identifiers (S1andO1). As
with other RL rules, the value of3.2on the RHS of this rule may be updated later
by reinforcement learning, whereas the value of 3.2 on the LHS will remain
unchanged.  If <code>&lt;v&gt;</code> had matched against a non-numeric constant, it will be
replaced by that constant on the LHS, but the RHS numeric-indifference
preference value will be set to zero to make the new rule valid.</p>
<p>The new productionâ€™s name adheres to the following pattern:rl<em>template-name</em>id,
where template-name is the name of the originating rule template and id is
monotonically increasing integer that guarantees the uniqueness of the name.</p>
<p>If an identical production already exists in production memory, then the newly
generated production is discarded. It should be noted that the current process
of identifying unique template match instances can become quite expensive in
long agent runs. Therefore, it is recommended to generate all necessary RL rules
using the gp command or via custom scripting when possible.</p>
<h3 id="chunking">Chunking</h3>
<p>Since RL rules are regular productions, they can be learned by chunking just
like any other production. This method is more general than using the gp command
or rule templates, and is useful if the environment state consists of
arbitrarily complex relational structures that cannot be enumerated.</p>
<h2 id="footnotes">Footnotes</h2>
<ul>
<li><a name="footnote1">[1]</a>: In this context, the term "state" refers to the
state of the task or environment, not a state identifier.  For the rest of this
chapter, bold capital letter names such as S1 will refer to identifiers and italic
lowercase names such as <span class="arithmatex">\(s_1\)</span> will refer to task states.</li>
<li><a name="footnote2">[2]</a>: This is assuming the value of
<strong>numeric-indifferent-mode</strong> is set to
<strong>sum</strong>. In general, the RL mechanism only works correctly when this is the
case, and we assume this case in the rest of the chapter. See page 198 for more
information about this parameter.</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../04_ProceduralKnowledgeLearning/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Procedural Knowledge Learning" rel="prev">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Procedural Knowledge Learning
              </div>
            </div>
          </a>
        
        
          
          <a href="../06_SemanticMemory/" class="md-footer__link md-footer__link--next" aria-label="Next: Semantic Memory" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Semantic Memory
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      SoarGroup &copy;
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.footer", "navigation.top", "navigation.indexes", "navigation.expand", "header.autohide"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>