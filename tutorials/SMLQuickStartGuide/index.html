
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../IntroSoarDebugger/">
      
      
        <link rel="next" href="../soar_tutorial/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.8">
    
    
      
        <title>Soar Markup Language - Soar documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sml-quick-start-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  This documentation is still work in progress. The documentation is hosted at <a href="https://soar.eecs.umich.edu">the Soar homepage</a>! 

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Soar documentation" class="md-header__button md-logo" aria-label="Soar documentation" data-md-component="logo">
      
  <img src="../../Images/soar.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Soar documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Soar Markup Language
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="http://github.com/SoarGroup/Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SoarGroup/Documentation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
    
  
  Soar

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../soar_manual/" class="md-tabs__link">
          
  
    
  
  Soar Manual

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../explanations/" class="md-tabs__link">
          
  
    
  
  Explanations

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../how_to/" class="md-tabs__link">
          
  
    
  
  HowTo Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/" class="md-tabs__link">
          
  
    
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../soar/tags/" class="md-tabs__link">
        
  
    
  
  Tag Index

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Soar documentation" class="md-nav__button md-logo" aria-label="Soar documentation" data-md-component="logo">
      
  <img src="../../Images/soar.png" alt="logo">

    </a>
    Soar documentation
  </label>
  
    <div class="md-nav__source">
      <a href="http://github.com/SoarGroup/Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SoarGroup/Documentation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Soar
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_1">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Soar
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
        
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Research
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/Publications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/ResearchGroups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Research Groups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/OtherAcademicInstitutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Academic Institutions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/CommercialSoarOrganizations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Commercial Soar Organizations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../soar_manual/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Soar Manual
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Soar Manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/01_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/02_TheSoarArchitecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Soar Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/03_SyntaxOfSoarPrograms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syntax of Soar Programs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/04_ProceduralKnowledgeLearning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Procedural Knowledge Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/05_ReinforcementLearning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/06_SemanticMemory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Semantic Memory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/07_EpisodicMemory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Episodic Memory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/08_SpatialVisualSystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial Visual System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/09_SoarUserInterface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soar User Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../soar_manual/blocksworld/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blocksworld
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../explanations/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Explanations
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Explanations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/BasicKernelTerminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Kernel Terminology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/DesignDogma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design Dogma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/ThreadsInSML/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threads in SML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/Timers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/Waterfall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Waterfall
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../IntroSoarDebugger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Soar Debugger Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Soar Markup Language
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Soar Markup Language
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple-sml-example" class="md-nav__link">
    Simple SML example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-example-explained" class="md-nav__link">
    Simple example explained
  </a>
  
    <nav class="md-nav" aria-label="Simple example explained">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-kernel" class="md-nav__link">
    Creating the kernel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-input-link-wmes" class="md-nav__link">
    Creating input link WME's
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#committing-changes" class="md-nav__link">
    Committing changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-soar" class="md-nav__link">
    Running Soar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieving-output" class="md-nav__link">
    Retrieving Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-command-line" class="md-nav__link">
    The Command Line
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capturing-print-output" class="md-nav__link">
    Capturing print output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    Events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events-in-tcl" class="md-nav__link">
    Events in Tcl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-an-environment" class="md-nav__link">
    Building an Environment
  </a>
  
    <nav class="md-nav" aria-label="Building an Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    Initialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialization-code-sample" class="md-nav__link">
    Initialization Code Sample
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input" class="md-nav__link">
    Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-world-code-sample" class="md-nav__link">
    Update World Code Sample
  </a>
  
    <nav class="md-nav" aria-label="Update World Code Sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-the-agents" class="md-nav__link">
    Running the agent(s)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-sample-code" class="md-nav__link">
    Run Sample Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-based-method-for-updating-the-world" class="md-nav__link">
    Event-based method for updating the world
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supporting-running-without-updating-the-environment" class="md-nav__link">
    Supporting running without updating the environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-flags" class="md-nav__link">
    Run Flags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integrating-with-other-clients-esp-the-debugger" class="md-nav__link">
    Integrating with other clients (esp. the debugger)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-and-handling-startstop-sample-code" class="md-nav__link">
    Registering and Handling Start/Stop Sample Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-details" class="md-nav__link">
    Further details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-other-languages" class="md-nav__link">
    Using other languages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-environments-in-java" class="md-nav__link">
    Example Environments in Java
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helpful-tips" class="md-nav__link">
    Helpful Tips
  </a>
  
    <nav class="md-nav" aria-label="Helpful Tips">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    Memory Management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boosting-performance" class="md-nav__link">
    Boosting Performance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../soar_tutorial/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Official Soar Tutorials
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_4_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Official Soar Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../soar_tutorial/TankEatersConfigFile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tank and Eaters Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../how_to/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    HowTo Guides
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            HowTo Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/BuildingSoarRos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Soar and ROS1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/CLIParsingCode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI Parsing Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/HowToCompileSmlClients/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to compile SML Clients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/IOAndRewardLinks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO and Reward Links
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/MemoryLeakDebuggingWithVisualStudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory Leak Debugging with Visual Studio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/SMLOutputLinkGuide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SML Output Link Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to/SoarTechnicalFAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soar Technical FAQ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/cli/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Command Line Interface
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_6_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Command Line Interface
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_alias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    alias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_trace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    trace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_help/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    help
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_sp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_load/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    load
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_gp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_wm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_rl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_default_wme_depth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    default_wme_depth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_stop_soar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stop_soar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_alias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    alias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_echo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    echo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_command_to_file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    command_to_file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_unalias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unalias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_epmem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    epmem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_clog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_visualize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    visualize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_preferences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    preference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_excise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    excise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_production/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    production
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_wma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_smem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_chunk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chunk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_soar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    soar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_svs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    svs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_explain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    explain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_init_soar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    init_soar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_decide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_print/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    print
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_debug/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    debug
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_timers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_watch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    watch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_save/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    save
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_max_nil_output_cycles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    max_nil_output_cycles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_file_system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/cmd_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    output
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../soar/tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tag Index
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple-sml-example" class="md-nav__link">
    Simple SML example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-example-explained" class="md-nav__link">
    Simple example explained
  </a>
  
    <nav class="md-nav" aria-label="Simple example explained">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-kernel" class="md-nav__link">
    Creating the kernel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-input-link-wmes" class="md-nav__link">
    Creating input link WME's
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#committing-changes" class="md-nav__link">
    Committing changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-soar" class="md-nav__link">
    Running Soar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieving-output" class="md-nav__link">
    Retrieving Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-command-line" class="md-nav__link">
    The Command Line
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capturing-print-output" class="md-nav__link">
    Capturing print output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    Events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events-in-tcl" class="md-nav__link">
    Events in Tcl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-an-environment" class="md-nav__link">
    Building an Environment
  </a>
  
    <nav class="md-nav" aria-label="Building an Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    Initialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialization-code-sample" class="md-nav__link">
    Initialization Code Sample
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input" class="md-nav__link">
    Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-world-code-sample" class="md-nav__link">
    Update World Code Sample
  </a>
  
    <nav class="md-nav" aria-label="Update World Code Sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-the-agents" class="md-nav__link">
    Running the agent(s)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-sample-code" class="md-nav__link">
    Run Sample Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-based-method-for-updating-the-world" class="md-nav__link">
    Event-based method for updating the world
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supporting-running-without-updating-the-environment" class="md-nav__link">
    Supporting running without updating the environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-flags" class="md-nav__link">
    Run Flags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integrating-with-other-clients-esp-the-debugger" class="md-nav__link">
    Integrating with other clients (esp. the debugger)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-and-handling-startstop-sample-code" class="md-nav__link">
    Registering and Handling Start/Stop Sample Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-details" class="md-nav__link">
    Further details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-other-languages" class="md-nav__link">
    Using other languages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-environments-in-java" class="md-nav__link">
    Example Environments in Java
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helpful-tips" class="md-nav__link">
    Helpful Tips
  </a>
  
    <nav class="md-nav" aria-label="Helpful Tips">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    Memory Management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boosting-performance" class="md-nav__link">
    Boosting Performance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <a href="../../soar/tags/#sml" class="md-tag">sml</a>
    
  
</nav>


  
  


<h1 id="sml-quick-start-guide">SML Quick Start Guide</h1>
<p>SML (Soar Markup Language) provides an interface into Soar based around sending
and receiving commands packaged as XML packets. The interface is designed to
support connecting environments to Soar (where input and output data structures
are sent back and forth) and to support debuggers (where commands to print out
specific productions or working memory elements are sent back and forth).</p>
<p>We refer to these environments and debuggers as "clients".</p>
<p>The details and motivation behind the development of the SML language are
described in the "Soar XML Interface Specification" which goes into a lot more
depth on the details of the XML dialect. However, for users this guide may be
largely sufficient.</p>
<p>We provide a series of classes that together hide the details of the XML
messaging system while allowing the client full control over Soar. This guide
will provide a quick introduction to using those classes.</p>
<p>The SML API is natively implemented in C++, but there are Java, Python, and Tcl
bindings automatically generated by SWIG. Although all examples used in this
document are in C++, it should be fairly intuitive how they translate into other
languages. Later in the document is a section containing example environments
written in Java.</p>
<p>This page explains how to compile SML clients in various languages.</p>
<h2 id="simple-sml-example">Simple SML example</h2>
<p>This example is something of a "hello world" example of how to use the major
elements of the SML API. Once you understand this example, you'll be pretty much
ready to dive in.</p>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">// Generally only need this one header file</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;sml_Client.h&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">sml</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1">// Create an instance of the Soar kernel in our process</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">Kernel</span><span class="o">*</span><span class="w"> </span><span class="n">pKernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kernel</span><span class="o">::</span><span class="n">CreateKernelInNewThread</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1">// Check that nothing went wrong.  We will always get back a kernel object</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c1">// even if something went wrong and we have to abort.</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">HadError</span><span class="p">())</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="p">{</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">GetLastErrorDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="p">}</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="c1">// Create a Soar agent named &quot;test&quot;</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="c1">// NOTE: We don&#39;t delete the agent pointer.  It&#39;s owned by the kernel</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">sml</span><span class="o">::</span><span class="n">Agent</span><span class="o">*</span><span class="w"> </span><span class="n">pAgent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">CreateAgent</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="c1">// Check that nothing went wrong</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="c1">// NOTE: No agent gets created if there&#39;s a problem, so we have to check for</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="c1">// errors through the kernel object.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">HadError</span><span class="p">())</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="p">{</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">GetLastErrorDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="p">}</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="c1">// Load some productions</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">LoadProductions</span><span class="p">(</span><span class="s">&quot;testsml.soar&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">HadError</span><span class="p">())</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="p">{</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">GetLastErrorDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="p">}</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="n">Identifier</span><span class="o">*</span><span class="w"> </span><span class="n">pInputLink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">GetInputLink</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="c1">// Create (I3 ^plane P1) (P1 ^type Boeing747 ^speed 200 ^direction 50.5) on</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="c1">// the input link.  (We don&#39;t own any of the returned objects).</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="n">Identifier</span><span class="o">*</span><span class="w"> </span><span class="n">pID</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">CreateIdWME</span><span class="p">(</span><span class="n">pInputLink</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;plane&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="n">StringElement</span><span class="o">*</span><span class="w"> </span><span class="n">pWME1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">CreateStringWME</span><span class="p">(</span><span class="n">pID</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Boeing747&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="n">IntElement</span><span class="o">*</span><span class="w"> </span><span class="n">pWME2</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">CreateIntWME</span><span class="p">(</span><span class="n">pID</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;speed&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="n">FloatElement</span><span class="o">*</span><span class="w"> </span><span class="n">pWME3</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">CreateFloatWME</span><span class="p">(</span><span class="n">pID</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;direction&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">50.5</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="c1">// Send the changes to working memory to Soar</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="c1">// With 8.6.2 this call is optional as changes are sent automatically.</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">Commit</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="c1">// Run Soar for 2 decisions</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">RunSelf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="c1">// Change (P1 ^speed) to 300 and send that change to Soar</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">Update</span><span class="p">(</span><span class="n">pWME2</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">Commit</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="c1">// Run Soar until it generates output or 15 decision cycles have passed</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a><span class="c1">// (More normal case is to just run for a decision rather than until output).</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">RunSelfTilOutput</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="c1">// Go through all the commands we&#39;ve received (if any) since we last ran Soar.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a><span class="kt">int</span><span class="w"> </span><span class="n">numberCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">GetNumberCommands</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numberCommands</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="p">{</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="w">        </span><span class="n">Identifier</span><span class="o">*</span><span class="w"> </span><span class="n">pCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">GetCommand</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">pCommand</span><span class="o">-&gt;</span><span class="n">GetCommandName</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pCommand</span><span class="o">-&gt;</span><span class="n">GetParameterValue</span><span class="p">(</span><span class="s">&quot;speed&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="w">        </span><span class="c1">// Update environment here to reflect agent&#39;s command</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="w">        </span><span class="c1">// Then mark the command as completed</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a><span class="w">        </span><span class="n">pCommand</span><span class="o">-&gt;</span><span class="n">AddStatusComplete</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="c1">// Or could do the same manually like this:</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="w">        </span><span class="c1">// pAgent-&gt;CreateStringWME(pCommand, &quot;status&quot;, &quot;complete&quot;) ;</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a><span class="p">}</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="c1">// See if anyone (e.g. a debugger) has sent commands to Soar</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="c1">// Without calling this method periodically, remote connections will be ignored if</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="c1">// we choose the &quot;CreateKernelInCurrentThread&quot; method.</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">CheckForIncomingCommands</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="c1">// Create an example Soar command line</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;excise --all&quot;</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="c1">// Execute the command</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">pResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">ExecuteCommandLine</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">GetAgentName</span><span class="p">())</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a><span class="c1">// Shutdown and clean up</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">Shutdown</span><span class="p">()</span><span class="w"> </span><span class="p">;</span><span class="w">   </span><span class="c1">// Deletes all agents (unless using a remote connection)</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a><span class="k">delete</span><span class="w"> </span><span class="n">pKernel</span><span class="w"> </span><span class="p">;</span><span class="w">                </span><span class="c1">// Deletes the kernel itself</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a><span class="p">}</span><span class="w"> </span><span class="c1">// end main</span>
</span></code></pre></div>
<h2 id="simple-example-explained">Simple example explained</h2>
<h3 id="creating-the-kernel">Creating the kernel</h3>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1">// Create an instance of the Soar kernel in our process</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">Kernel</span><span class="o">*</span><span class="w"> </span><span class="n">pKernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kernel</span><span class="o">::</span><span class="n">CreateKernelInNewThread</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>The client can either create a local Soar kernel or a remote connection to an
existing Soar kernel (where commands are sent over a socket to a separate
process on the same or a different machine).</p>
<p>The local kernel can either be created in the same thread as the caller or in a
new thread.</p>
<p>Using the same thread will generally be a bit faster, but it requires the client
to periodically call <code>pKernel-&gt;CheckForIncomingCommands()</code> so that the kernel has
a chance to check for commands coming in from other remote processes (e.g. from
a debugger). So if you want maximum speed choose the current thread option, but
your code will be a bit more complicated. If speed is not as critical then
choose the new thread option. The speed difference isn't that large, perhaps a
factor of two on the cost of making a call - which will often be dwarfed by the
cost of matching productions or updating the environment.</p>
<p>As you are just reading the "SML Quick Start Guide" I would strongly recommend
you use <code>CreateKernelInNewThread</code> until you are somewhat familiar with the system.
If you find you need higher performance later, switching over to the
CurrentThread model later only requires changing this one line of code.</p>
<h3 id="creating-input-link-wmes">Creating input link WME's</h3>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">// Create (I3 ^plane P1) (P1 ^type Boeing747 ^speed 200 ^direction 50.5) on</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1">// the input link.  (We don&#39;t own any of the returned objects).</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">Identifier</span><span class="o">*</span><span class="w"> </span><span class="n">pID</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">CreateIdWME</span><span class="p">(</span><span class="n">pInputLink</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;plane&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">StringElement</span><span class="o">*</span><span class="w"> </span><span class="n">pWME1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">CreateStringWME</span><span class="p">(</span><span class="n">pID</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Boeing747&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>The client can build up an arbitrarily complex graph of working memory elements
(WMEs) attached to the input-link. Each WME consists of a triplet: <code>(identifier ^attribute value)</code>.
The first identifier comes from "getInputLink" and then new identifiers are
created by <code>CreateIdWME()</code> and new simple WMEs are created through
<code>CreateStringWME</code>/<code>CreateIntWME</code>/<code>CreateFloatWME</code>.</p>
<p>A WME's value can be updated through the <code>pAgent-&gt;Update()</code> method and it can be
removed through <code>pAgent-&gt;DestroyWME()</code> which also makes the working memory object
invalid.</p>
<p>A graph (rather than a simple tree) can be created through
<code>pAgent-&gt;CreateSharedIdWME()</code>. This creates a new identifier WME with the same
value as an existing identifier. (E.g. given <code>pOrig = (P7 ^object O3)</code> then
<code>CreateSharedIdWME(pInputLink, "same", pOrig)</code> would create <code>(I1 ^same O3)</code>).</p>
<h3 id="committing-changes">Committing changes</h3>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// Send the changes to working memory to Soar</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">Commit</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>The client must explicitly request that changes to working memory be sent over
to Soar. This explicit command allows the communication layer to be more
efficient, by collecting all changes together and sending them as a single
command. With 8.6.2 changes are sent over immediately they are made so Commit()
is unnecessary. This produces slightly worse performance (as changes are not
collected together into a single packet) so to get maximum performance call
SetAutoCommit(false) and write the manual commit calls.</p>
<h3 id="running-soar">Running Soar</h3>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">// Run Soar until it generates output or 15 decision cycles have passed</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">RunSelfTilOutput</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1">// Run Soar for 2 decisions</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">RunSelf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>In most real environments, Soar should be run with
<code>pKernel-&gt;RunAllAgentsForever()</code> and then use a call to <code>pKernel-&gt;StopAllAgents()</code>
to interrupt. This allows a user to run the environment from a debugger as well
as from the environment.</p>
<p>There's more discussion of this in Section 2 of this document.</p>
<h3 id="retrieving-output">Retrieving Output</h3>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">// Go through all the commands we&#39;ve received (if any) since we last ran Soar.</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">numberCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">GetNumberCommands</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numberCommands</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="p">{</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">        </span><span class="n">Identifier</span><span class="o">*</span><span class="w"> </span><span class="n">pCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">GetCommand</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">pCommand</span><span class="o">-&gt;</span><span class="n">GetCommandName</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pCommand</span><span class="o">-&gt;</span><span class="n">GetParameterValue</span><span class="p">(</span><span class="s">&quot;speed&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">        </span><span class="c1">// Update environment here to reflect agent&#39;s command</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">        </span><span class="c1">// Then mark the command as completed</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">        </span><span class="n">pCommand</span><span class="o">-&gt;</span><span class="n">AddStatusComplete</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="c1">// Or could do the same manually like this:</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">        </span><span class="c1">// pAgent-&gt;CreateStringWME(pCommand, &quot;status&quot;, &quot;complete&quot;) ;</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="p">}</span>
</span></code></pre></div>
<p>There is direct support provided for an output model where "commands" are
represented as distinction identifier's on the output-link. For example, if the
output-link identifier is O1 then the agent might add a move command with
<code>(O1 ^move M1)</code> <code>(M1 ^speed 20)</code>.</p>
<p>If you choose to adopt this model for the agent's actions then it is possible to
query the agent for the number of commands added since the last time Soar was
run and to retrieve each Command in turn, its name and parameter values. In this
example, pCommand would point to M1, the name would be move and the parameter
value for speed would be 20.</p>
<p>If you wish to adopt a different model for agent actions, that is also
supported, but the support is less direct.</p>
<p>First, notice that GetCommand() returns a standard Identifier WME, so this can
be manipulated in the same manner as any other WME. In particular Identifier's
offer GetNumberChildren and GetChild methods, so using these it is possible to
start from the output link and examine all of working memory beneath the output
link. There are also other methods (such as FindByAttribute) that can make this
search more efficient.</p>
<p>Secondly, you can use <code>IsJustAdded()</code> and <code>AreChildrenModified()</code> on WMEs on the
output-link (and below) to determine what has changed since the last time Soar
was run.</p>
<p>Third, you can call <code>AddOutputHandler()</code> to register a function that is called
whenever a specific attribute is added to the output link.</p>
<p>Finally, if that is not sufficient, it is possible to call
<code>GetNumberOutputLinkChanges()</code> and <code>GetOutputLinkChange()</code> to get a list of all of
the WMEs to have been added or removed since the last time Soar was run.</p>
<p>From this collection of methods it should be possible to support just about any
manner of output model you wish to adopt, but we would recommend the "Command"
model shown above.</p>
<h3 id="the-command-line">The Command Line</h3>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">// Create an example Soar command line</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;excise --all&quot;</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c1">// Execute the command</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">pResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pKernel</span><span class="o">-&gt;</span><span class="n">ExecuteCommandLine</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">GetAgentName</span><span class="p">())</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>To this point the discussion has been purely about environments and supporting
I/O. However, the <code>ExecuteCommandLine</code> methods allow a client to send any command
to Soar that can be typed at the Soar command prompt. Using this method,
productions can be loaded, excised, printed out etc.</p>
<p><code>ExecuteCommandLineXML()</code> is also available which returns the output as a
structured XML message, making it easier and safer for a client to parse values
from the output. See the online documentation for details the format of that XML
output for each command.</p>
<h3 id="capturing-print-output">Capturing print output</h3>
<p>To capture output during a run you need to register for the <code>smlEVENT_PRINT</code> event
which will be called periodically during the course of the run. To do this you
need to define a handler function which will be called during the run. Here's a
simple example:</p>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">MyPrintEventHandler</span><span class="p">(</span><span class="n">smlPrintEventId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pUserData</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="o">*</span><span class="w"> </span><span class="n">pAgent</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">pMessage</span><span class="p">)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="p">{</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">        </span><span class="c1">// In this case the user data is a string we&#39;re building up</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">*</span><span class="w"> </span><span class="n">pTrace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">*</span><span class="p">)</span><span class="n">pUserData</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">        </span><span class="p">(</span><span class="o">*</span><span class="n">pTrace</span><span class="p">)</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">pMessage</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="p">}</span>
</span></code></pre></div>
<p>The method includes a piece of "userData" which is defined by you when you
register for the event. In this case we would have:</p>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">callbackp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">RegisterForPrintEvent</span><span class="p">(</span><span class="n">smlEVENT_PRINT</span><span class="p">,</span><span class="w"> </span><span class="n">MyPrintEventHandler</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">trace</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>Note how the string "trace" is passed into the registration function. This
object is then passed back to the handler, which uses it to build up a complete
trace. After this handler has been registered calling:</p>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAgent</span><span class="o">-&gt;</span><span class="n">Run</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>would run Soar for 4 decisions and the trace output would be collected in the
string "trace".</p>
<p>There is now also another way to get this output by registering for
<code>smlEVENT_XML_TRACE_OUTPUT</code>. This event sends XML objects rather than text
strings. Displaying these to the user requires more work by the client, but if
the client wishes to parse the text working with XML is much easier. This is the
approach taken in the Java debugger.</p>
<h3 id="events">Events</h3>
<p>There are a lot of events you can register for and the list given here will
surely grow over time. Here are the types of the handlers in C++ and Java (the
Java ones are a little different from the C++ and are more error prone as
they're checked at runtime not at compile time):</p>
<p>C++ event handlers (if you're not sure how to convert these types into functions
look at the example of the print handler in the previous section):</p>
<div class="language-C++ highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">// Handler for Run events.</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1">// Passed back the event ID, the agent and the phase together with whatever user data we registered with the client</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">RunEventHandler</span><span class="p">)(</span><span class="n">smlRunEventId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pUserData</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="o">*</span><span class="w"> </span><span class="n">pAgent</span><span class="p">,</span><span class="w"> </span><span class="n">smlPhase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1">// Handler for Agent events (such as creation/destruction etc.).</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">AgentEventHandler</span><span class="p">)(</span><span class="n">smlAgentEventId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pUserData</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="o">*</span><span class="w"> </span><span class="n">pAgent</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c1">// Handler for Print events.</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">PrintEventHandler</span><span class="p">)(</span><span class="n">smlPrintEventId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pUserData</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="o">*</span><span class="w"> </span><span class="n">pAgent</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">pMessage</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c1">// Handler for Production manager events.</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">ProductionEventHandler</span><span class="p">)(</span><span class="n">smlProductionEventId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pUserData</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="o">*</span><span class="w"> </span><span class="n">pAgent</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">pProdName</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">pInstantion</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="c1">// Handler for System events.</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">SystemEventHandler</span><span class="p">)(</span><span class="n">smlSystemEventId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pUserData</span><span class="p">,</span><span class="w"> </span><span class="n">Kernel</span><span class="o">*</span><span class="w"> </span><span class="n">pKernel</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="c1">// Handler for XML events.  The data for the event is passed back in pXML.</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="c1">// NOTE: To keep a copy of the ClientXML* you are passed use ClientXML* pMyXML = new ClientXML(pXML) to create</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="c1">// a copy of the object.  This is very efficient and just adds a reference to the underlying XML message object.</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="c1">// You need to delete ClientXML objects you create and you should not delete the pXML object you are passed.</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">XMLEventHandler</span><span class="p">)(</span><span class="n">smlXMLEventId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pUserData</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="o">*</span><span class="w"> </span><span class="n">pAgent</span><span class="p">,</span><span class="w"> </span><span class="n">ClientXML</span><span class="o">*</span><span class="w"> </span><span class="n">pXML</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="c1">// Handler for RHS (right hand side) function firings</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="c1">// pFunctionName and pArgument define the RHS function being called (the client may parse pArgument to extract other values)</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="c1">// The return value is a string which allows the RHS function to create a symbol: e.g. ^att (exec plus 2 2) producing ^att 4</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="c1">// NOTE: This is the one place in clientSML where we use a std::string in an interface.  If you wish to compile with a pure &quot;C&quot; interface</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="c1">// this can be replaced by a handler that is passed a buffer and a length.  The length is passed within the framework already (from the kernel to here)</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="c1">// so this is an easy transition.</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="k">typedef</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">RhsEventHandler</span><span class="p">)(</span><span class="n">smlRhsEventId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pUserData</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="o">*</span><span class="w"> </span><span class="n">pAgent</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">pFunctionName</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">pArgument</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>Java event handlers are based on implementing an interface within an object:</p>
<p>From Kernel:</p>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">SystemEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">systemEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Kernel</span><span class="w"> </span><span class="n">kernel</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="p">}</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">UpdateEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Kernel</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">runFlags</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="p">}</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">StringEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">stringEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">userData</span><span class="p">,</span><span class="w"> </span><span class="n">Kernel</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">callbackData</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="p">}</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">AgentEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">agentEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">agentName</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="p">}</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">RhsFunctionInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">rhsFunctionHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">agentName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">functionName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">argument</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="p">}</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ClientMessageInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">clientMessageHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">agentName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">functionName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">argument</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>From Agent:</p>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">RunEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">runEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">phase</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="p">}</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ProductionEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">productionEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">prodName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">instantiation</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="p">}</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">PrintEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">printEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="p">}</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">xmlEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">xmlEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">ClientXML</span><span class="w"> </span><span class="n">xml</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="p">}</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">OutputEventInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">outputEventHandler</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">agentName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">attributeName</span><span class="p">,</span><span class="w"> </span><span class="n">WMElement</span><span class="w"> </span><span class="n">pWmeAdded</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="p">}</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">OutputNotificationInterface</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">outputNotificationHandler</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="p">}</span>
</span></code></pre></div>
<p>Examples of implementations:</p>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">runEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">phase</span><span class="p">)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="p">{</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received run event in Java&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="p">}</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="c1">// We pass back the agent&#39;s name because the Java Agent object may not yet</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c1">// exist for this agent yet.  The underlying C++ object *will* exist by the</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c1">// time this method is called.  So instead we look up the Agent object</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="c1">// from the kernel with GetAgent().</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">agentEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">agentName</span><span class="p">)</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="p">{</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received agent event in Java&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="p">}</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">productionEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">prodName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">instantiation</span><span class="p">)</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="p">{</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received production event in Java&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="p">}</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">systemEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Kernel</span><span class="w"> </span><span class="n">kernel</span><span class="p">)</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="p">{</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received system event in Java&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="p">}</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">printEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="p">{</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received print event in Java: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="p">}</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">xmlEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">ClientXML</span><span class="w"> </span><span class="n">xml</span><span class="p">)</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="p">{</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">xmlText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xml</span><span class="p">.</span><span class="na">GenerateXMLString</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received xml trace event in Java: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xmlText</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">allChildren</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xml</span><span class="p">.</span><span class="na">GetNumberChildren</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a><span class="w">                </span><span class="n">ClientXML</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClientXML</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span class="w">                </span><span class="n">xml</span><span class="p">.</span><span class="na">GetChild</span><span class="p">(</span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a>
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a><span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">childText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">.</span><span class="na">GenerateXMLString</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a><span class="w">                </span><span class="n">allChildren</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">childText</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-44"><a id="__codelineno-13-44" name="__codelineno-13-44" href="#__codelineno-13-44"></a>
</span><span id="__span-13-45"><a id="__codelineno-13-45" name="__codelineno-13-45" href="#__codelineno-13-45"></a><span class="w">                </span><span class="n">child</span><span class="p">.</span><span class="na">delete</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-46"><a id="__codelineno-13-46" name="__codelineno-13-46" href="#__codelineno-13-46"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-13-47"><a id="__codelineno-13-47" name="__codelineno-13-47" href="#__codelineno-13-47"></a>
</span><span id="__span-13-48"><a id="__codelineno-13-48" name="__codelineno-13-48" href="#__codelineno-13-48"></a><span class="p">}</span>
</span><span id="__span-13-49"><a id="__codelineno-13-49" name="__codelineno-13-49" href="#__codelineno-13-49"></a>
</span><span id="__span-13-50"><a id="__codelineno-13-50" name="__codelineno-13-50" href="#__codelineno-13-50"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">testRhsHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">agentName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">functionName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">argument</span><span class="p">)</span>
</span><span id="__span-13-51"><a id="__codelineno-13-51" name="__codelineno-13-51" href="#__codelineno-13-51"></a><span class="p">{</span>
</span><span id="__span-13-52"><a id="__codelineno-13-52" name="__codelineno-13-52" href="#__codelineno-13-52"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Received rhs function event in Java for function: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">functionName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;(&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-53"><a id="__codelineno-13-53" name="__codelineno-13-53" href="#__codelineno-13-53"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;My rhs result &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-13-54"><a id="__codelineno-13-54" name="__codelineno-13-54" href="#__codelineno-13-54"></a><span class="p">}</span>
</span></code></pre></div>
<p>To see more about events look at the sml_ClientEvents.h header file or the TestSMLEvents test program (currently located in the Tools folder).</p>
<h3 id="events-in-tcl">Events in Tcl</h3>
<p>Tcl requires that callbacks to a Tcl interpreter happen in the same thread as
the interpreter is executing in. By default, this will not always happen for SML
events. This is because there is an event thread started up by SML (running in
the client) which is used to check for incoming events and make the necessary
callback calls.</p>
<p>Therefore for Tcl we recommend shutting down this event thread and polling
explicitly for incoming events. This can be done in a few lines of code like
this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a># We want to make sure to handle events in the Tcl thread
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a># so we turn off the event thread and poll for events instead.
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>$_kernel StopEventThread
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>checkForEvents $_kernel
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a># Explicitly check for incoming commands and events every n milliseconds
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>proc checkForEvents {k} {
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>   $k CheckForIncomingCommands
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>   after 10 checkForEvents $k
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>}
</span></code></pre></div>
<p>This assumes <code>$_kernel</code> is a variable set to the SML kernel object. Note, the
after 10 triggers another call to the <code>checkForEvents()</code> method after a 10ms
delay. Making this value larger will make Tcl less responsive to events. Making
it smaller will consume more CPU time checking for events.</p>
<h3 id="building-an-environment">Building an Environment</h3>
<p>If you are converting an existing SGIO environment you should also read the
"Moving from SGIO to SML" document as well as this section.</p>
<p>The Java implementation of Towers of Hanoi (TOH) is a useful reference, showing
a simple environment environment. I'll use that to as an example here, so the
code snippets will be in Java, but a very similar approach can be taken in other
languages (currently Tcl or C++).</p>
<h4 id="initialization">Initialization</h4>
<p>The first step is to create an instance of the kernel and then create an agent.
The name passed to <code>CreateKernelInNewThread</code> is the name of the library to load
(DLL on Windows). This is optional in 8.6.2 and defaults to SoarKernelSML.</p>
<p>It is important to check for an error using the <code>kernel.HadError()</code> method.
CreateKernel will not return an empty kernel object even if initialization
fails. This is deliberate design to ensure that meaningful errors can be
reported to the user.</p>
<h4 id="initialization-code-sample">Initialization Code Sample</h4>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1">// create our Soar kernel</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">kernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kernel</span><span class="p">.</span><span class="na">CreateKernelInNewThread</span><span class="p">();</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kernel</span><span class="p">.</span><span class="na">HadError</span><span class="p">())</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="p">{</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="c1">// Better to use a Message Box to display this if your platform/toolkit allows.</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error creating kernel: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="na">GetLastErrorDescription</span><span class="p">())</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="p">}</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="na">CreateAgent</span><span class="p">(</span><span class="n">AGENT_NAME</span><span class="p">);</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="kt">boolean</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">agent</span><span class="p">.</span><span class="na">LoadProductions</span><span class="p">(</span><span class="s">&quot;towers-of-hanoi-SML.soar&quot;</span><span class="p">);</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">load</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">agent</span><span class="p">.</span><span class="na">HadError</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Error loading productions: &quot;</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="n">agent</span><span class="p">.</span><span class="na">GetLastErrorDescription</span><span class="p">());</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="input">Input</h4>
<p>Mapping from the environment's state to input values involves calls to create, update and destroy working memory elements using calls like these:</p>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">agent</span><span class="p">.</span><span class="na">Create</span><span class="o">&lt;</span><span class="n">type</span><span class="o">&gt;</span><span class="n">WME</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">g</span><span class="p">.</span><span class="w"> </span><span class="n">agent</span><span class="p">.</span><span class="na">CreateIntWME</span><span class="p">)</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">agent</span><span class="p">.</span><span class="na">Update</span><span class="p">()</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">agent</span><span class="p">.</span><span class="na">DestroyWME</span>
</span></code></pre></div>
<p>Working memory elements are linked together to form a tree (actually a graph)
with the input link as the root of the tree. To get the input link identifier
(the top of the tree) call <code>agent.GetInputLink()</code>.</p>
<p>A key step after making multiple calls to modify the input link is to call
Commit(). All changes to working memory are buffered (in the environment) until
the moment Commit is called, at which point they are all sent over as a single
large message to the kernel. This greatly improves performance, but you must
remember to call Commit before running the agent or your changes won't actually
appear on the agent's input link. This was changed in 8.6.2 so the default now
is that Commit() is called automatically each time a wme is modified on the
input link. To enable the faster version which then requires manual calls to
Commit() call SetAutoCommit(false). Calling Commit multiple times during a
single input cycle will not cause problems.</p>
<h4 id="output">Output</h4>
<p>The most common way to examine output from an agent is to use the "Commands"
model. With this method the agent places each output command on the output-link
using the format:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>(X ^output-link I3)
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>(I3 ^command-name C1)
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>(C1 ^param1 value ^param2 value)
</span></code></pre></div>
<p>Thus the name of the command appears directly under the output-link and all
parameters are added to the command identifier and can only be one level deep.
(If you wish to use an alternative model see below).</p>
<p>If the agent adopts this format for output commands they can be easily retrieved
by the environment using code like this:</p>
<h3 id="update-world-code-sample">Update World Code Sample</h3>
<p>Procedure:</p>
<ol>
<li>Get Output</li>
<li>Change-World-State</li>
<li>Send Input</li>
</ol>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateWorld</span><span class="p">()</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">        </span><span class="c1">// See if any commands were generated on the output link</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">        </span><span class="c1">// (In general we might want to update the world when the agent</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">        </span><span class="c1">// takes no action in which case some code would be outside this if statement</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">        </span><span class="c1">// but for this environment that&#39;s not necessary).</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">agent</span><span class="p">.</span><span class="na">Commands</span><span class="p">())</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">                </span><span class="c1">// perform the command on the output link</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">                </span><span class="n">Identifier</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">agent</span><span class="p">.</span><span class="na">GetCommand</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">command</span><span class="p">.</span><span class="na">GetCommandName</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">MOVE_DISK</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Unknown Command: &quot;</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">                            </span><span class="o">+</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">GetCommandName</span><span class="p">());</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">GetParameterValue</span><span class="p">(</span><span class="n">SOURCE_PEG</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">                        </span><span class="n">command</span><span class="p">.</span><span class="na">GetParameterValue</span><span class="p">(</span><span class="n">DESTINATION_PEG</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Parameter(s) missing for Command &quot;</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="w">                            </span><span class="o">+</span><span class="w"> </span><span class="n">MOVE_DISK</span><span class="p">);</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">srcPeg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">GetParameterValue</span><span class="p">(</span><span class="s">&quot;source-peg&quot;</span><span class="p">).</span><span class="na">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">;</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">dstPeg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">GetParameterValue</span><span class="p">(</span><span class="s">&quot;destination-peg&quot;</span><span class="p">).</span><span class="na">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">;</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="w">                </span><span class="c1">// Change the state of the world and generate new input</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="w">                </span><span class="n">moveDisk</span><span class="p">(</span><span class="n">srcPeg</span><span class="p">,</span><span class="w"> </span><span class="n">dstPeg</span><span class="p">);</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a><span class="w">                </span><span class="c1">// Tell the agent that this command has executed in the environment.</span>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a><span class="w">                </span><span class="n">command</span><span class="p">.</span><span class="na">AddStatusComplete</span><span class="p">();</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a><span class="w">                </span><span class="c1">// Send the new input link changes to the agent</span>
</span><span id="__span-18-29"><a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a><span class="w">                </span><span class="n">agent</span><span class="p">.</span><span class="na">Commit</span><span class="p">();</span>
</span><span id="__span-18-30"><a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a>
</span><span id="__span-18-31"><a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a><span class="w">                </span><span class="c1">// &quot;agent.GetCommand(n)&quot; is based on watching for changes to the output link</span>
</span><span id="__span-18-32"><a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a><span class="w">                </span><span class="c1">// so before we do a run we clear the last set of changes.</span>
</span><span id="__span-18-33"><a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a><span class="w">                </span><span class="c1">// (You can always read the output link directly and not use the</span>
</span><span id="__span-18-34"><a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a><span class="w">                </span><span class="c1">//  commands model to determine what has changed between runs).</span>
</span><span id="__span-18-35"><a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a><span class="w">                </span><span class="n">agent</span><span class="p">.</span><span class="na">ClearOutputLinkChanges</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-18-36"><a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a>
</span><span id="__span-18-37"><a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isAtGoalState</span><span class="p">())</span>
</span><span id="__span-18-38"><a id="__codelineno-18-38" name="__codelineno-18-38" href="#__codelineno-18-38"></a><span class="w">                    </span><span class="n">fireAtGoalState</span><span class="p">();</span>
</span><span id="__span-18-39"><a id="__codelineno-18-39" name="__codelineno-18-39" href="#__codelineno-18-39"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-18-40"><a id="__codelineno-18-40" name="__codelineno-18-40" href="#__codelineno-18-40"></a><span class="p">}</span>
</span></code></pre></div>
<p>The method <code>GetCommandName</code> and <code>GetParameterValue</code> extract the appropriate
attributes and values from the output link and return them to the environment.</p>
<p>The method <code>AddStatusComplete()</code> adds <code>(C1 ^status complete)</code> to the command
structure, indicating to the agent that this command has executed and can now be
removed by the agent.</p>
<p>(Note that this is simple form of input that in this case is sent to the output
link rather than the input link. This is technically a bit of "back door" input,
but is simpler than passing a large structure to the input link and having the
agent match up the two. This addition is made during the agent's next input
cycle as with all input).</p>
<p>In order for the Commands method to work, the system has to keep track of
changes to working memory as only newly added commands are reported through the
GetCommand method. For this process to work, the environment must call
<code>ClearOutputLinkChanges()</code> before running the agent again.</p>
<p>While this Command model should be sufficient for almost all environments, if
there is a need to process other structures, the environment can always choose
to ignore this model partially or completely. First, the method <code>GetCommand</code>
returns an Identifier object. The environment can use the methods
<code>GetNumberChildren</code> and <code>GetChild</code> to walk this Identifier and locate any arbitrary
working memory element beneath an Identifier or the environment can use the
<code>FindByAttribute</code> method to retrieve the values of working memory elements that
have a particular attribute.</p>
<p>In fact a environment can abandon the Command model completely and simply call
<code>GetOutputLink()</code> to get the Identifier object at the top of the output link and
proceed to examine the tree (graph) from there.</p>
<h4 id="running-the-agents">Running the agent(s)</h4>
<p>There are two main methods for running an agent:</p>
<ul>
<li><code>RunSelfForever()</code> and it's twin <code>RunAllAgentsForever()</code></li>
<li><code>RunSelf(1)</code> and <code>RunAllAgents(1)</code> (to step the environment rather than running it).</li>
</ul>
<p>The trick here is that the code for running the agents should be separate from
the code for updating the world (collecting output; updating world state;
sending input). By separating the two we can either issue the run from the
environment or from a debugger (or other client) and everything works correctly.</p>
<p>Let's assume we have the <code>updateWorld()</code> method from above, which should have the form:</p>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">updateWorld</span><span class="p">()</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="p">{</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="n">check</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">output</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">    </span><span class="n">update</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">    </span><span class="n">send</span><span class="o">-</span><span class="k">new</span><span class="o">-</span><span class="n">input</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="p">}</span>
</span></code></pre></div>
<p>Then the code samples below show how to connect up the system so that
updateWorld() is only called once all agents have completed the output phase
(i.e. at the end of a decision cycle).</p>
<h3 id="run-sample-code">Run Sample Code</h3>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="p">{</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="n">m_StopNow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">    </span><span class="c1">// Start a run</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">    </span><span class="c1">// (since this is single agent could use agent.RunSelfForever() instead, but this shows how to run multi-agent environments)</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">    </span><span class="n">kernel</span><span class="p">.</span><span class="na">RunAllAgentsForever</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="p">}</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">step</span><span class="p">()</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="p">{</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">    </span><span class="c1">// Run one decision</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">    </span><span class="n">kernel</span><span class="p">.</span><span class="na">RunAllAgents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="p">}</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">()</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="p">{</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">    </span><span class="c1">// We&#39;d like to call StopSoar() directly from here but we&#39;re in a different</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">    </span><span class="c1">// thread and right now this waits patiently for the runForever call to finish</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">    </span><span class="c1">// before it executes...not really the right behavior.  So instead we use a flag and</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="w">    </span><span class="c1">// issue StopSoar() in a callback.</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">    </span><span class="n">m_StopNow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="event-based-method-for-updating-the-world">Event-based method for updating the world</h3>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerForUpdateWorldEvent</span><span class="p">()</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="p">{</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="kt">int</span><span class="w"> </span><span class="n">updateCallback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="na">RegisterForUpdateEvent</span><span class="p">(</span><span class="n">sml</span><span class="p">.</span><span class="na">smlUpdateEventId</span><span class="p">.</span><span class="na">smlEVENT_AFTER_ALL_OUTPUT_PHASES</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;updateEventHandler&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Kernel</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">runFlags</span><span class="p">)</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="p">{</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">        </span><span class="c1">// Might not call updateWorld() depending on runFlags in a fuller environment.</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">        </span><span class="c1">// See the section below for more on this.</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">        </span><span class="n">updateWorld</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">        </span><span class="c1">// We have a problem at the moment with calling Stop() from arbitrary threads</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="w">        </span><span class="c1">// so for now we&#39;ll make sure to call it within an event callback.</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="w">        </span><span class="c1">// Do this test after calling updateWorld() so that method can set m_StopNow if it</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="w">        </span><span class="c1">// wishes and trigger an immediate stop.</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_StopNow</span><span class="p">)</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="w">        </span><span class="n">m_StopNow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="w">        </span><span class="n">kernel</span><span class="p">.</span><span class="na">StopAllAgents</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="p">}</span>
</span></code></pre></div>
<p>The Run code is pretty simple. The only issues to be aware of are:</p>
<ul>
<li><code>RunAllAgentsForever()</code> is currently (8.6.2) a blocking call, so we usually
  spawn a thread and issue this call in that thread.</li>
<li><code>StopAllAgents()</code> can currently <strong>not</strong> be called from an arbitrary thread (or it
  blocks waiting for the Run to terminate). This may be fixed in a later version,
  but for now calling it from an event callback solves this problem.</li>
</ul>
<p>The way <code>updateWorld()</code> is called is after the <code>smlEVENT_AFTER_ALL_OUTPUT_PHASES</code>
event fires. Why bother to do this rather than writing run as:</p>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">stopped</span><span class="p">)</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="p">{</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">    </span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">    </span><span class="n">update</span><span class="o">-</span><span class="n">world</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="p">}</span>
</span></code></pre></div>
<p>There are two basic reasons. First, there are no guarantees that <code>run(1)</code> will run
for a decision. If we include breakpoints on productions or phase transitions
this call may run for less time, possibly confusing the environment (as the
agents have not progressed as far as expected). Second, by making the call to
<code>updateWorld()</code> event based, we can issue arbitrary run commands from a debugger
and the environment will function correctly. For more on this see the
"Event-Driven Environments Proposal.doc" file.</p>
<p>Also in Tcl please be sure to read about how to poll for events in Tcl (see
Section 1.6.1).</p>
<h3 id="supporting-running-without-updating-the-environment">Supporting running without updating the environment</h3>
<p>For some environments it may make sense to allow the user to run an agent
without starting the environment. This can be helpful when debugging one agent
or having reached a particular situation in the world, stopping and wanting to
step slowly to observe the reasoning.</p>
<p>To support this the environment should check the runFlags parameter passed to
the updateEventHandler. This is a bit field which currently consists of the
values in this enum:</p>
<h3 id="run-flags">Run Flags</h3>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">typedef</span><span class="w"> </span><span class="kd">enum</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="n">sml_NONE</span><span class="w">                </span><span class="o">=</span><span class="w">  </span><span class="mi">0</span><span class="p">,</span><span class="w">           </span><span class="c1">// No special flags set</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="n">sml_RUN_SELF</span><span class="w">            </span><span class="o">=</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">      </span><span class="c1">// User included --self flag when running agent</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="n">sml_RUN_ALL</span><span class="w">             </span><span class="o">=</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">      </span><span class="c1">// User ran all agents</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">    </span><span class="n">sml_UPDATE_WORLD</span><span class="w">        </span><span class="o">=</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">      </span><span class="c1">// User explicitly requested world to update</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">    </span><span class="n">sml_DONT_UPDATE_WORLD</span><span class="w">   </span><span class="o">=</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">      </span><span class="c1">// User explicitly requested world to not update</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="p">}</span><span class="w"> </span><span class="n">smlRunFlags</span><span class="w"> </span><span class="p">;</span>
</span></code></pre></div>
<p>Based on these flags, the environment should decide whether to update or not. We
leave this entirely to the discretion of the designer because different
combinations may make sense for different situations but this might be a typical
set (for a multi-agent environment):</p>
<p>if <code>sml_RUN_SELF</code> set and <code>SML_UPDATE_WORLD</code> not set or <code>sml_DONT_UPDATE_WORLD</code> set
then don't call <code>updateWorld()</code>.</p>
<p>The meaning of this would be that:</p>
<ul>
<li><code>run --self</code> would cause the agent to run but not the environment</li>
<li><code>run --noupdate</code> would cause all agents to run but not the environment</li>
<li><code>run --self --update</code> would cause one agent to run and update the environment</li>
<li><code>run</code> would cause all agents to run and update the environment.</li>
</ul>
<p>You are free to make other choices if there's a compelling reason.</p>
<h3 id="integrating-with-other-clients-esp-the-debugger">Integrating with other clients (esp. the debugger)</h3>
<p>One final issue is updating the controls in the environment correctly if the
user runs Soar from the debugger and not the environment (e.g. disabling the run
button and enabling stop during a run).</p>
<p>There are two approaches to this. First, ignore the problem and don't
enable/disable controls. Instead, just handle errors if the user tries to issue
a second run while a run is already going ahead. The second option is to
register for the <code>smlEVENT_SYSTEM_START</code> and <code>smlEVENT_SYSTEM_STOP</code> events and use
these to enable/ disable the UI in the environment in appropriate ways.</p>
<p>Here's an example for implementing this support:</p>
<h3 id="registering-and-handling-startstop-sample-code">Registering and Handling Start/Stop Sample Code</h3>
<div class="language-Java highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerForStartStopEvents</span><span class="p">()</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="p">{</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kernel</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">startCallback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="na">RegisterForSystemEvent</span><span class="p">(</span><span class="n">smlSystemEventId</span><span class="p">.</span><span class="na">smlEVENT_SYSTEM_START</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="err"></span><span class="n">systemEventHandler</span><span class="err"></span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">stopCallback</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="na">RegisterForSystemEvent</span><span class="p">(</span><span class="n">smlSystemEventId</span><span class="p">.</span><span class="na">smlEVENT_SYSTEM_STOP</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="err"></span><span class="n">systemEventHandler</span><span class="err"></span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="p">}</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">systemEventHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">eventID</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Kernel</span><span class="w"> </span><span class="n">kernel</span><span class="p">)</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="p">{</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eventID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">sml</span><span class="p">.</span><span class="na">smlSystemEventId</span><span class="p">.</span><span class="na">smlEVENT_SYSTEM_START</span><span class="p">.</span><span class="na">swigValue</span><span class="p">())</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">                </span><span class="c1">// The callback comes in on Soar&#39;s thread and we have to update the buttons</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">                </span><span class="c1">// on the UI thread, so switch threads.</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">                </span><span class="n">dpy</span><span class="p">.</span><span class="na">asyncExec</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Runnable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">updateButtons</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eventID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">sml</span><span class="p">.</span><span class="na">smlSystemEventId</span><span class="p">.</span><span class="na">smlEVENT_SYSTEM_STOP</span><span class="p">.</span><span class="na">swigValue</span><span class="p">())</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="w">                </span><span class="c1">// The callback comes in on Soar&#39;s thread and we have to update the buttons</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="w">                </span><span class="c1">// on the UI thread, so switch threads.</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a><span class="w">                </span><span class="n">dpy</span><span class="p">.</span><span class="na">asyncExec</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Runnable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">updateButtons</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="p">}</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateButtons</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">running</span><span class="p">)</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a><span class="p">{</span>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a><span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="na">isAtGoalState</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a>
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a><span class="w">        </span><span class="n">startButton</span><span class="p">.</span><span class="na">setEnabled</span><span class="p">(</span><span class="o">!</span><span class="n">running</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">done</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a><span class="w">        </span><span class="n">stopButton</span><span class="p">.</span><span class="na">setEnabled</span><span class="p">(</span><span class="n">running</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a><span class="w">        </span><span class="n">resetButton</span><span class="p">.</span><span class="na">setEnabled</span><span class="p">(</span><span class="o">!</span><span class="n">running</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">done</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a><span class="w">        </span><span class="n">stepButton</span><span class="p">.</span><span class="na">setEnabled</span><span class="p">(</span><span class="o">!</span><span class="n">running</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">done</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="further-details">Further details</h3>
<p>To learn more about ClientSML and SML in general, the best documentation is the
header files for the methods in ClientSML. In particular, <code>sml_ClientKernel.h</code>,
<code>sml_ClientAgent.h</code> and <code>sml_ClientIdentifier.h</code> contain a lot of useful methods and
explanations.</p>
<p>Beyond that check the Soar XML Interface Spec and any other documentation in its
vicinity.</p>
<h3 id="using-other-languages">Using other languages</h3>
<p>The Tcl and Java interfaces were generated by <a href="http://www.swig.org">SWIG</a>. We
have provided some custom code to help SWIG out in a few places, mostly with
callbacks. If you're interested in creating interfaces for other languages that
SWIG supports, check out the SWIG documentation and try to follow our existing
solutions.</p>
<p>A Tcl package, called Tcl_sml_ClientInterface is available. On Windows it is
located in the soar-library directory. This can be used by including the
following line in your Tcl code:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>package require tcl_sml_clientinterface
</span></code></pre></div>
<p>Note that the directory where the package resides must be added to Tcl's
auto_path variable. The available functions are direct translations of their C++
counterparts. See TOHtest.tcl in soar-library for examples showing how to use
the Tcl interface. The Tcl package includes <em>Tcl_sml_ClientInterface.dll</em> (or the
equivalent for other platforms), which is required.</p>
<h3 id="example-environments-in-java">Example Environments in Java</h3>
<p>Here are two example clients written in Java, intended to explain the basics of
using SML in that language. Thorough explanatory comments are inlined.</p>
<ol>
<li>A very simple Soar environment.</li>
<li>HelloWorld.java</li>
<li>helloworld.soar</li>
<li>A more complex interactive asynchronous environment.</li>
<li>SimpleAsyncEnv.java</li>
<li>simpleasyncenv.soar</li>
</ol>
<h2 id="helpful-tips">Helpful Tips</h2>
<h3 id="memory-management">Memory Management</h3>
<p>Memory management is actually really easy. Generally, the only objects you
should explicitly delete are the kernel object and any objects you directly
allocated through a call to new. In Java and Tcl, this generally means you can
just let things go out of scope when you're done with them. There are a couple
special cases you should be aware of, though:</p>
<ul>
<li>Agent objects are automatically deleted when the owning Kernel object is
  deleted (actually, when the call to Kernel::Shutdown is made, which you should
  always make before deleting the kernel). If you want to destroy an agent
  earlier, you can by making a call to <code>Kernel::destroyAgent</code>. Under no circumstances
  should you delete (in the C++ sense) an Agent object.</li>
<li>In Java if you create a ClientXML object through <code>xml = new ClientXML()</code> you
  should call <code>xml.delete()</code> on it when you're done. This isn't strictly required
  (the garbage collector will get it eventually) but is good practice and will
  avoid messages about leaked memory when the application shuts down. As per the
  general rule, in C++ if you create it with new you're responsible for destroying
  it with delete.</li>
<li>Since there can be multiple clients interacting with the same kernel and
  agents, your application needs to be listening for the appropriate events so if
  some other client deletes/destroys a kernel or agent your application is using,
  you don't crash. Specifically, listen for the <code>BEFORE_AGENT_DESTROYED</code> and
  <code>BEFORE_SHUTDOWN</code> events so you can clean things up as needed in your application.</li>
</ul>
<h3 id="boosting-performance">Boosting Performance</h3>
<p>It is often desirable to maximize the performance of your SML application. This
section assumes that you just want to make things as fast as possible after you
have finished debugging your application. Debugging is an inherently slow
process, so these tips will be less helpful while you're still debugging.</p>
<ul>
<li>Compile with optimizations turned on. In Visual Studio this means doing a
  release build. On Linux and OS X, the default settings are probably sufficient,
  but you can experiment with new settings if you want (let us know if you find
  better settings).</li>
<li>Put primary application and Soar in the same process. That is, use
  <code>CreateInNewThread</code> or <code>CreateInCurrentThread</code>, not <code>CreateRemoteConnection</code>. Using a
  remote kernel means socket communications are used, which is slow.</li>
<li>Don't register for unnecessary events. Every event that is registered for
  causes extra work to be done. Try to find an appropriate event to register for
  so you don't end up getting more event calls than you actually need - that is,
  try to avoid registering for events which occur more frequently than you need
  and then filtering them on the application side.</li>
<li>Don't connect the debugger. Connecting the debugger creates a remote
  connection and also registers for several events.</li>
<li>Set watch level 0. Even if you don't have a client registered for any of the
  print or XML events, work is still done internally to generate some of the
  information that would have been sent out. Setting watch level 0 avoids this
  work.</li>
<li>Disable monitor productions. Again, even if no client is registered to print
  out the text of monitor productions, work is still done internally to prepare
  the text. Monitor productions can be disabled by excising them or commenting
  them out, but an easier method is to have each monitor production test a debug
  flag in working memory which is set by some initialization production or
  operator. Thus all of the monitor productions can be turned on or off by
  changing one line of code.</li>
<li>Disable timers. Soar uses timers internally to generate the output of the
  stats command. If you don't need this information, you can use the timers - off
  command to disable this bookkeeping. This can make a significant difference in
  the watch 0 case.</li>
<li>Avoid running agents separately. Instead of calling <code>RunSelf</code> or
  <code>RunSelfTilOutput</code> on each agent, just call <code>RunAllAgents</code> on the kernel itself.
  This runs all agents together and avoids the overhead of running them
  separately. The absolute best you can do is to call <code>RunAllAgentsForever</code> as
  described in section 2.4 - this avoids repeatedly calling the run functions at
  all and will make it easier to stop and restart your application from the
  debugger (or other clients).</li>
<li>In the case where the absolute best performance under SML is desired, use
  <code>CreateKernelInCurrentThread</code> instead of <code>CreateKernelInNewThread</code> and set the
  "optimized" flag to true in the parameters passed to
  <code>CreateKernelInCurrentThread</code>. This means Soar will execute in the same thread as
  your application. Without this each call to and from the Soar kernel requires a
  context switch (assuming a single processor machine). This method also
  eliminates the thread which polls for new events. This means you must poll for
  the events yourself by periodically calling <code>CheckForIncomingCommands</code>, which is
  a little more work for the programmer.</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../IntroSoarDebugger/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Java Soar Debugger Intro" rel="prev">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Java Soar Debugger Intro
              </div>
            </div>
          </a>
        
        
          
          <a href="../soar_tutorial/" class="md-footer__link md-footer__link--next" aria-label="Next: Soar Tutorial" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Soar Tutorial
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      SoarGroup &copy;
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.footer", "navigation.top", "navigation.indexes", "navigation.expand", "header.autohide"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>